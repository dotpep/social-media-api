name: Build and Deploy Code

on: [push, pull_request]

env:
  ACCESS_TOKEN_EXPIRE_MINUTES: ${{ vars.ACCESS_TOKEN_EXPIRE_MINUTES }}
  ALGORITHM: HS256

jobs:
  my_first_job:
    environment: 
      name: testing
    env:
      DATABASE_HOSTNAME: ${{ secrets.DATABASE_HOSTNAME }}
      DATABASE_PORT: ${{ secrets.DATABASE_PORT }}
      DATABASE_PASSWORD: ${{ secrets.DATABASE_PASSWORD }}
      DATABASE_NAME: ${{ secrets.DATABASE_NAME }}
      DATABASE_USERNAME: ${{ secrets.DATABASE_USERNAME }}
      SECRET_KEY: ${{ secrets.SECRET_KEY }}
    runs-on: ubuntu-20.04
    steps:
      - name: Pulling Git Repo
        uses: actions/checkout@v4
      - name: Install Python version 3.10
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - name: Update pip
        run: python -m pip install --upgrade pip
      - name: Install dependencies
        run: pip install -r requirements.txt
      - name: Run tests with PyTest
        run: |
          pip install pytest
          pytest -v

  my_second_job:
    runs-on: ubuntu-20.04
    steps:
      - name: Checking Github Actions global secrets and variables
        run: |
          echo "${{ secrets.DATABASE_HOSTNAME }}"
          echo DATABASE_HOSTNAME
      - name: Checking Github Environment secrets
        run: |
          echo DATABASE_PASSWORD
      - name: Checking Github Environment variables
        run: |
          echo "${{ vars.ACCESS_TOKEN_EXPIRE_MINUTES }}"
          echo ACCESS_TOKEN_EXPIRE_MINUTES

